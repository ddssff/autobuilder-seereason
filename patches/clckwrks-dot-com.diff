--- old/clckwrks-dot-com.cabal	2012-12-20 23:31:34.000000000 -0800
+++ new/clckwrks-dot-com.cabal	2012-12-21 05:47:44.357018538 -0800
@@ -27,7 +27,7 @@
                        clckwrks-theme-clckwrks  == 0.2.*,
                        clckwrks-plugin-bugs     == 0.3.*,
                        clckwrks-plugin-media    == 0.3.*,
-                       containers               == 0.4.*,
+                       containers               >= 0.4,
                        happstack-server         >= 7.0 && < 7.2,
                        hsp                      == 0.7.*,
                        mtl                      >= 2.0 && < 2.2,
--- old/clckwrks-dot-com.cabal	2012-12-06 08:47:42.000000000 -0800
+++ new/clckwrks-dot-com.cabal	2012-12-06 08:49:46.069545349 -0800
@@ -12,7 +12,7 @@
 
 Flag backups
      Description: enable the backups executable (currently disabled by default do to wacky dependencies not on hackage)
-     Default: False
+     Default: True
 
 Executable             clckwrks-dot-com-server
   main-is:             Main.hs
--- old/debian/Debianize.hs	2012-12-21 12:46:13.621189606 -0800
+++ old/debian/Debianize.hs	2012-12-21 12:46:13.645189607 -0800
@@ -1,6 +1,6 @@
 import Data.List (isPrefixOf)
 import Debian.Relation (BinPkgName(..))
-import Distribution.Debian (Flags(..), defaultFlags, Executable(..), Server(..), Site(..), tightDependencyFixup)
+import Distribution.Debian (Flags(..), Config(..), defaultFlags, Executable(..), Server(..), Site(..), tightDependencyFixup)
 import Distribution.Debian.DebHelper (DebAtom(..))
 import Distribution.Debian.Debianize
 import Distribution.Debian.Server (databaseDirectory)
@@ -12,11 +12,12 @@
     do jstreePath <- Clckwrks.getDataFileName "jstree"
        json2Path  <- Clckwrks.getDataFileName "json2"
        Distribution.Debian.Debianize.debianize $
-         defaultFlags { missingDependencies = ["libghc-clckwrks-theme-clckwrks-doc"]
+         Config { flags = defaultFlags
+                      { missingDependencies = ["libghc-clckwrks-theme-clckwrks-doc"]
                       , executablePackages  = map (theSite jstreePath json2Path "clckwrks-dot-com-server") serverNames ++ [backups]
                       , haddock             = True
-                      , revision            = ""
-                      , modifyAtoms = \ atoms ->
+                      , revision            = "" }
+                , modifyAtoms = \ atoms ->
                           map fixRulesHead atoms ++
                           concatMap
                             (\ package -> tightDependencyFixup package
@@ -27,8 +28,7 @@
                                               ("libghc-clckwrks-plugin-media-dev", "haskell-clckwrks-plugin-media-utils"),
                                               ("libghc-clckwrks-plugin-bugs-dev", "haskell-clckwrks-plugin-bugs-utils"),
                                               ("libghc-clckwrks-dev", "haskell-clckwrks-utils")])
-                              serverNames
-                      }
+                              serverNames }
     where
       serverNames = map BinPkgName ["clckwrks-dot-com-production"] -- , "clckwrks-dot-com-staging", "clckwrks-dot-com-development"]
       -- Insert a line just above the debhelper.mk include
@@ -59,7 +59,8 @@
                           _                             -> Nothing
                     , headerMessage = "Generated by clckwrks-dot-com/Setup.hs"
                     , retry = "60"
-                    , flags = [ "--http-port", show portNum
+                    , serverFlags =
+                              [ "--http-port", show portNum
                               , "--hide-port"
                               , "--hostname", hostname
                               , "--top", databaseDirectory this
